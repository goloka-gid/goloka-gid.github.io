<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∏—Ä –≠–ª–ª–∏</title>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;700&family=Lora:ital,wght@0,400;1,500&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #fdfbf7 0%, #e8e3f5 100%);
            --accent: #9b87f5;
            --text-color: #4a4a6a;
        }

        body {
            font-family: 'Comfortaa', cursive;
            background: var(--bg-gradient);
            background-attachment: fixed;
            color: var(--text-color);
            margin: 0; padding: 20px;
            min-height: 100vh;
            -webkit-tap-highlight-color: transparent;
        }

        h1 { text-align: center; color: #7c67d6; font-size: 22px; margin-bottom: 20px; }

        /* –°–µ—Ç–∫–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ */
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; max-width: 500px; margin: 0 auto; }
        
        .day-card {
            background: rgba(255,255,255,0.7);
            backdrop-filter: blur(10px);
            border-radius: 20px; padding: 15px 5px; text-align: center;
            box-shadow: 0 8px 20px rgba(155, 135, 245, 0.15);
            border: 1px solid white; transition: 0.3s;
            display: flex; flex-direction: column; align-items: center;
        }
        .day-card:active { transform: scale(0.95); background: white; }
        .day-num { font-size: 9px; color: #aaa; margin-bottom: 4px; }
        .day-icon { font-size: 28px; margin-bottom: 5px; }
        .day-name { font-size: 10px; font-weight: bold; line-height: 1.2; }

        /* –°—Ç—Ä–∞–Ω–∏—Ü–∞ —á—Ç–µ–Ω–∏—è */
        #content-page {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-gradient); z-index: 1000; overflow: hidden;
        }

        .scroll-container {
            height: 100%; overflow-y: auto; scroll-behavior: smooth;
            padding: 20px; padding-bottom: 100px; box-sizing: border-box;
        }

        .nav-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        
        .magic-scroll-btn {
            background: white; border: none; padding: 8px 16px;
            border-radius: 50px; color: var(--accent); font-weight: bold; font-family: 'Comfortaa';
            box-shadow: 0 4px 12px rgba(155, 135, 245, 0.3); font-size: 12px;
        }

        /* –¢–µ–∫—Å—Ç –∏—Å—Ç–æ—Ä–∏–∏ (—ç—Ñ—Ñ–µ–∫—Ç –∫–Ω–∏–≥–∏) */
        .magic-text {
            font-family: 'Lora', serif;
            font-size: 18px;
            line-height: 1.8;
            color: #3a2b5d;
            /* –≠—Ñ—Ñ–µ–∫—Ç –æ–±—ä–µ–º–∞ –±—É–∫–≤ */
            text-shadow: 0.5px 0.5px 0px rgba(255,255,255,0.8), 1px 1px 3px rgba(155, 135, 245, 0.1);
            white-space: pre-wrap; /* –°–û–•–†–ê–ù–Ø–ï–¢ –í–°–ï –û–¢–°–¢–£–ü–´ –ò–ó JSON */
            margin: 20px 0;
        }

        .section-box {
            background: rgba(255,255,255,0.5);
            border-radius: 25px; padding: 20px; margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.7);
        }

        .back-btn { background: none; border: none; font-size: 24px; cursor: pointer; }
        
        audio { width: 100%; margin-top: 10px; border-radius: 10px; }
    </style>
</head>
<body>

    <div id="main-view">
        <h1>‚ú® –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≠–ª–ª–∏</h1>
        <div class="grid" id="main-grid"></div>
    </div>

    <div id="content-page">
        <div class="scroll-container" id="scroll-box">
            <div class="nav-bar">
                <button class="back-btn" onclick="closeDay()">üîô</button>
                <button class="magic-scroll-btn" id="scroll-btn" onclick="toggleAutoScroll()">‚ú® –ù–∞—á–∞—Ç—å —á—Ç–µ–Ω–∏–µ</button>
            </div>
            
            <h2 id="title-label" style="text-align: center; color: var(--accent); font-size: 24px;"></h2>

            <div class="section-box">
                <div id="story-display" class="magic-text"></div>
            </div>

            <div class="section-box">
                <h3 style="color: var(--accent); font-size: 16px; margin-top:0;">üéµ –°–ª—É—à–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é</h3>
                <audio id="audio-player" controls></audio>
            </div>
            
            <div class="section-box">
                <h3 style="color: var(--accent); font-size: 16px; margin-top:0;">üßò –ü—Ä–∞–∫—Ç–∏–∫–∞</h3>
                <div id="practice-display" class="magic-text" style="font-size: 16px;"></div>
            </div>
        </div>
    </div>

    <script>
        // –ü–û–õ–ù–´–ô —Å–ø–∏—Å–æ–∫ –∏–∑ 30 –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
        const items = [
            {n: "–í–æ–ª—à–µ–±–Ω–∞—è –ö–∏—Å—Ç—å", i: "üñåÔ∏è"}, {n: "–ó–µ—Ä–∫–∞–ª–æ –ú–µ—á—Ç—ã", i: "ü™û"}, {n: "–ö–æ–º–ø–∞—Å –ù–∞–º–µ—Ä–µ–Ω–∏–π", i: "üß≠"},
            {n: "–°—É–Ω–¥—É–∫ –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–µ–π", i: "üì¶"}, {n: "–ê–º—É–ª–µ—Ç –°–∏–ª—ã", i: "üßø"}, {n: "–í–æ–ª—à–µ–±–Ω—ã–π –ü–æ—è—Å", i: "üéóÔ∏è"},
            {n: "–©–∏—Ç –ù–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏", i: "üõ°Ô∏è"}, {n: "–ú–æ—Å—Ç –†–∞–¥–æ—Å—Ç–∏", i: "üåà"}, {n: "–õ–æ–≤–µ—Ü –ú—ã—Å–ª–µ–π", i: "üï∏Ô∏è"},
            {n: "–í–æ–ª—à–µ–±–Ω–∞—è –ö–Ω–æ–ø–∫–∞", i: "üîò"}, {n: "–†—é–∫–∑–∞–∫ –ü–æ–¥–¥–µ—Ä–∂–∫–∏", i: "üéí"}, {n: "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –°–∞–¥", i: "üå≥"},
            {n: "–°–≤–µ—Ç–æ—Ñ–æ—Ä –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏—è", i: "üö•"}, {n: "–î–æ–º–∏–∫ –°–ø–æ–∫–æ–π—Å—Ç–≤–∏—è", i: "üè†"}, {n: "–í–æ–ª—à–µ–±–Ω—ã–π –®–∞–≥", i: "üë£"},
            {n: "–í–æ–ª—à–µ–±–Ω—ã–µ –û—á–∫–∏", i: "üëì"}, {n: "–û–¥–µ—è–ª–æ –ó–∞–±–æ—Ç—ã", i: "üõå"}, {n: "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –§–æ–Ω–∞—Ä–∏–∫", i: "üî¶"},
            {n: "–í–æ–ª—à–µ–±–Ω–æ–µ –°–µ—Ä–¥—Ü–µ", i: "üíñ"}, {n: "–õ–µ—Å –¢–∏—à–∏–Ω—ã", i: "üå≤"}, {n: "–í–æ–ª–Ω–∞ –†–∞–¥–æ—Å—Ç–∏", i: "üåä"},
            {n: "–°–≤–µ—Ç–ª—è—á–æ–∫ –ó–∞–±–æ—Ç—ã", i: "ü™î"}, {n: "–í–æ–ª—à–µ–±–Ω–æ–µ –£—Ö–æ", i: "üëÇ"}, {n: "–†–µ–∫–∞ –ü—Ä–∏–Ω—è—Ç–∏—è", i: "üö£"},
            {n: "–õ–∞–º–ø–æ—á–∫–∞ –û—Å–æ–∑–Ω–∞–Ω–∏—è", i: "üí°"}, {n: "–ö—Ä—ã–ª—å—è –ú–µ—á—Ç—ã", i: "ü™Ω"}, {n: "–ö—Ä–∏—Å—Ç–∞–ª–ª –ß–µ—Å—Ç–Ω–æ—Å—Ç–∏", i: "üíé"},
            {n: "–ó–æ–ª–æ—Ç–∞—è –ù–∏—Ç—å", i: "üßµ"}, {n: "–ó–≤–µ–∑–¥–∞ –ù–∞–¥–µ–∂–¥—ã", i: "‚≠ê"}, {n: "–í–æ–ª—à–µ–±–Ω—ã–π –ö–ª—é—á", i: "üîë"}
        ];

        let isScrolling = false;
        let scrollInterval;

        const grid = document.getElementById('main-grid');
        items.forEach((item, i) => {
            const card = document.createElement('div');
            card.className = 'day-card';
            card.innerHTML = `
                <div class="day-num">–î–ï–ù–¨ ${i+1}</div>
                <div class="day-icon">${item.i}</div>
                <div class="day-name">${item.n}</div>
            `;
            card.onclick = () => openDay(i + 1, item.n);
            grid.appendChild(card);
        });

        async function openDay(num, name) {
            const container = document.getElementById('scroll-box');
            container.scrollTop = 0; // –°–±—Ä–æ—Å –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –≤ –Ω–∞—á–∞–ª–æ
            
            document.getElementById('title-label').innerText = name;
            document.getElementById('audio-player').src = `audio/day${num}_story.mp3`;
            
            try {
                const res = await fetch(`texts/day${num}.json`);
                const data = await res.json();
                document.getElementById('story-display').innerText = data.story;
                // –û–±—ä–µ–¥–∏–Ω—è–µ–º –¥–µ—Ç—Å–∫—É—é –∏ –≤–∑—Ä–æ—Å–ª—É—é –ø—Ä–∞–∫—Ç–∏–∫–∏
                document.getElementById('practice-display').innerText = data.child + "\n\n---\n\n" + data.adult;
            } catch (e) {
                document.getElementById('story-display').innerText = "–ò—Å—Ç–æ—Ä–∏—è —Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è...";
                document.getElementById('practice-display').innerText = "";
            }

            document.getElementById('content-page').style.display = 'block';
            document.getElementById('main-view').style.display = 'none';
        }

        function toggleAutoScroll() {
            const container = document.getElementById('scroll-box');
            const btn = document.getElementById('scroll-btn');
            
            if (isScrolling) {
                clearInterval(scrollInterval);
                btn.innerText = "‚ú® –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å";
            } else {
                scrollInterval = setInterval(() => {
                    container.scrollTop += 1; 
                    if (container.scrollTop + container.clientHeight >= container.scrollHeight - 10) {
                        clearInterval(scrollInterval);
                        btn.innerText = "‚ú® –í –Ω–∞—á–∞–ª–æ";
                        isScrolling = false;
                    }
                }, 40); // –°–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏
                btn.innerText = "‚è∏ –ü–∞—É–∑–∞";
            }
            isScrolling = !isScrolling;
        }

        function closeDay() {
            clearInterval(scrollInterval);
            isScrolling = false;
            document.getElementById('scroll-btn').innerText = "‚ú® –ù–∞—á–∞—Ç—å —á—Ç–µ–Ω–∏–µ";
            document.getElementById('audio-player').pause();
            document.getElementById('content-page').style.display = 'none';
            document.getElementById('main-view').style.display = 'block';
        }

        const tg = window.Telegram.WebApp;
        tg.ready(); tg.expand();
    </script>
</body>
</html>
