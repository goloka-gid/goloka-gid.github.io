<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ú–∏—Ä –≠–ª–ª–∏</title>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;700&family=Lora:ital,wght@0,400;1,500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

    <div id="view-grid" class="view-section active-view">
        <h1>‚ú® –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≠–ª–ª–∏</h1>
        <p style="text-align:center; font-size:10px; opacity:0.3;" onclick="resetTimer()">[–°–±—Ä–æ—Å —Ç–∞–π–º–µ—Ä–∞ (—Ç–µ—Å—Ç)]</p>
        <div class="grid" id="main-grid"></div>
    </div>

    <div id="paywall-modal" class="modal-overlay">
        <div class="modal-card">
            <button class="btn-close" onclick="closePaywall()">‚úñ</button>
            <div class="modal-icon">üîí</div>
            <div class="modal-title">–î–µ–Ω—å –∑–∞–∫—Ä—ã—Ç</div>
            <div class="modal-text">–í–≤–µ–¥–∏ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞.</div>
            <input type="text" id="access-code" class="code-input" placeholder="–ö–æ–¥ –¥–æ—Å—Ç—É–ø–∞" oninput="this.value = this.value.toUpperCase()">
            <button class="btn-buy btn-primary" id="btn-main-action" onclick="checkCode()">‚ú® –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
            <button class="btn-buy btn-secondary" id="btn-secondary-action" onclick="openSpecialOffer()">üí¨ –ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥ (–ù–∞–ø–∏—Å–∞—Ç—å –§–µ–µ)</button>
        </div>
    </div>

    <div id="offer-modal" class="modal-overlay">
        <div class="modal-card">
            <button class="btn-close" onclick="closeOffer()">‚úñ</button>
            <div id="offer-content-active" style="display:none;">
                <div class="modal-icon">üéÅ</div>
                <div class="modal-title">–°–µ–∫—Ä–µ—Ç–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ!</div>
                <div id="timer-display" class="timer-display">15:00</div>
                <div class="pricing-card highlight">
                    <div class="offer-label-highlight">–°–∫–∏–¥–∫–∞ 90%</div>
                    <div style="font-size:12px; margin-bottom:5px;">–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –¥–Ω—è–º</div>
                    <div class="price-row"><span class="old-price">30000 ‚ÇΩ</span><span class="new-price red">3000 ‚ÇΩ</span></div>
                    <button class="btn-buy btn-discount" style="margin-bottom:0" onclick="goToTelegram('full_discount')">–ö—É–ø–∏—Ç—å –í–°–Å –∑–∞ 3000 ‚ÇΩ</button>
                </div>
                <div class="pricing-card">
                    <div class="offer-label-normal" id="single-day-label">–î–æ—Å—Ç—É–ø –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –¥–Ω—é</div>
                    <div class="price-row"><span class="old-price">1000 ‚ÇΩ</span><span class="new-price">100 ‚ÇΩ</span></div>
                    <button class="btn-buy btn-normal" style="margin-bottom:0" onclick="goToTelegram('single_discount')">–ö—É–ø–∏—Ç—å –∑–∞ 100 ‚ÇΩ</button>
                </div>
            </div>
            <div id="offer-content-expired" style="display:none;">
                <div class="modal-icon">üóùÔ∏è</div>
                <div class="modal-title">–ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø</div>
                <div class="modal-text">–°–∫–∏–¥–∫–∞ –∏—Å—Ç–µ–∫–ª–∞. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç:</div>
                <div class="pricing-card full-price">
                    <div class="offer-label-normal">–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø</div>
                    <div class="price-row"><span class="new-price">30 000 ‚ÇΩ</span></div>
                    <button class="btn-buy btn-primary" style="margin-bottom:0" onclick="goToTelegram('full_price')">–ö—É–ø–∏—Ç—å –∑–∞ 30 000 ‚ÇΩ</button>
                </div>
                <div class="pricing-card full-price">
                    <div class="offer-label-normal" id="expired-single-label">–î–æ—Å—Ç—É–ø –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –¥–Ω—é</div>
                    <div class="price-row"><span class="new-price">1 000 ‚ÇΩ</span></div>
                    <button class="btn-buy btn-secondary" style="margin-bottom:0" onclick="goToTelegram('single_price')">–ö—É–ø–∏—Ç—å –∑–∞ 1 000 ‚ÇΩ</button>
                </div>
            </div>
        </div>
    </div>

    <div id="donate-modal" class="modal-overlay">
        <div class="modal-card">
            <button class="btn-close" onclick="closeDonate()">‚úñ</button>
            <div class="modal-icon">üôè</div>
            <div class="modal-title">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞</div>
            <div id="donate-step-1">
                <div class="modal-text">–ï—Å–ª–∏ –≤—ã –Ω–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ø–æ–∫—É–ø–∫—É, –≤–æ–∑–º–æ–∂–Ω–æ, –≤—ã –∑–∞—Ö–æ—Ç–∏—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –Ω–∞—Å?</div>
                <button class="btn-buy btn-donate-action" onclick="showDonateInfo()">–•–æ—á—É –ø—Ä–æ—Å—Ç–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ</button>
            </div>
            <div id="donate-step-2" style="display:none;">
                <div class="modal-text">–í—ã –º–æ–∂–µ—Ç–µ —Å–¥–µ–ª–∞—Ç—å –ª—é–±–æ–π –ø–µ—Ä–µ–≤–æ–¥ —É–¥–æ–±–Ω—ã–º –¥–ª—è –≤–∞—Å —Å–ø–æ—Å–æ–±–æ–º.</div>
                <div style="margin: 15px 0; font-size:12px; color:#444; background:#f0f0f0; padding:10px; border-radius:10px;">–†–µ–∫–≤–∏–∑–∏—Ç—ã –ø–æ —Å—Å—ã–ª–∫–µ –Ω–∏–∂–µ üëá</div>
                <button class="btn-buy btn-primary" onclick="window.open('https://t.me/donate_gid', '_blank')">–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ</button>
            </div>
        </div>
    </div>

    <div id="view-menu" class="view-section">
        <button class="simple-back" onclick="goHome()">‚¨Ö –ö –∫–∞—Ä—Ç–µ –¥–Ω–µ–π</button>
        <h2 id="menu-title" style="margin-top: 0;"></h2>
        <div class="menu-container">
            <div class="menu-btn" onclick="openContent('story')"><span class="menu-icon">üìñ</span><div><div style="font-weight:bold">–°–∫–∞–∑–æ—á–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è</div><div style="font-size:11px; opacity:0.7">–ß–∏—Ç–∞—Ç—å –∏ —Å–ª—É—à–∞—Ç—å</div></div></div>
            <div class="menu-btn" onclick="openContent('video')"><span class="menu-icon">üé¨</span><div><div style="font-weight:bold">–°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ</div><div style="font-size:11px; opacity:0.7">–í–æ–ª—à–µ–±–Ω—ã–π –º—É–ª—å—Ç—Ñ–∏–ª—å–º</div></div></div>
            <div class="menu-btn" onclick="openContent('song')"><span class="menu-icon">üéµ</span><div><div style="font-weight:bold">–ü–µ—Å–µ–Ω–∫–∞ –¥–Ω—è</div><div style="font-size:11px; opacity:0.7">–¢–∞–Ω—Ü—É–π –∏ –ø–æ–π</div></div></div>
            <div class="menu-btn" onclick="openContent('child')"><span class="menu-icon">üë∂</span><div><div style="font-weight:bold">–ü—Ä–∞–∫—Ç–∏–∫–∞ –¥–ª—è –¥–µ—Ç–µ–π</div><div style="font-size:11px; opacity:0.7">–¥–æ 15 –ª–µ—Ç</div></div></div>
            <div class="menu-btn" onclick="openContent('adult')"><span class="menu-icon">üßò‚Äç‚ôÄÔ∏è</span><div><div style="font-weight:bold">–í–∑—Ä–æ—Å–ª–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞</div><div style="font-size:11px; opacity:0.7">–û—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç—å –¥–ª—è —Ç–µ–±—è</div></div></div>
        </div>
    </div>

    <div id="view-content" class="view-section">
        <div class="header-fixed">
            <button class="nav-btn" onclick="goHome()">üè† –î–Ω–∏</button>
            <span id="header-title" style="font-size:12px; font-weight:bold; max-width: 120px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"></span>
            <button class="nav-btn" onclick="goBackToMenu()">üîô –ú–µ–Ω—é</button>
        </div>
        <div class="scroll-wrapper" id="scroll-box">
            <div style="padding: 15px;">
                <div id="status-message" style="display:none; text-align:center; padding:20px; color:#999;"></div>
                <div id="video-area" style="display:none;">
                    <div class="section-box" style="text-align: center;">
                        <h3 style="color: var(--accent); margin:0 0 10px 0;">üé¨ –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞!</h3>
                        <div class="video-wrapper"><video id="video-player" controls playsinline></video></div>
                    </div>
                </div>
                <img id="main-image" src="" class="book-media" style="display:none;">
                <div class="section-box" id="text-box" style="display:none;"><div id="text-display" class="magic-text"></div></div>
                <div class="section-box" id="audio-box" style="display:none;"><h3 id="audio-title" style="color: var(--accent); margin-top:0; font-size: 16px;">üéß –°–ª—É—à–∞—Ç—å</h3><audio id="audio-player" controls></audio></div>
            </div>
        </div>
        <button class="fab-scroll" id="scroll-btn" onclick="toggleAutoScroll()">‚ú®</button>
    </div>

    <script>
        // –í–ê–ñ–ù–û: –ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å. –¢–µ–ø–µ—Ä—å –º—ã –Ω–µ –∑–∞–≤–∏—Å–∏–º –æ—Ç —Ç–æ–≥–æ, –æ—Ç–∫—É–¥–∞ –æ—Ç–∫—Ä—ã—Ç —Ñ–∞–π–ª.
        const BASE_URL = 'https://goloka-gid.github.io/';

        // –†–µ–∑–µ—Ä–≤–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–∞ —Å–ª—É—á–∞–π –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
        const day1_backup = {
            child: `<p><b>üé® –î–µ–Ω—å 1. –í–æ–ª—à–µ–±–Ω–∞—è –ö–∏—Å—Ç—å</b></p><p>–ü—Ä–µ–¥—Å—Ç–∞–≤—å: —Ç—ã –ø—Ä–æ—Å—ã–ø–∞–µ—à—å—Å—è —É—Ç—Ä–æ–º, –ø–æ—Ç—è–≥–∏–≤–∞–µ—à—å—Å—è ‚Äî –∏ –≤–¥—Ä—É–≥ —á—É–≤—Å—Ç–≤—É–µ—à—å –ª—ë–≥–∫–æ–µ —Ç–µ–ø–ª–æ –≤ –ª–∞–¥–æ–Ω–∏. –¢—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—à—å –≥–ª–∞–∑–∞ –∏ –≤–∏–¥–∏—à—å... –µ—ë! –ù–µ–≤–∏–¥–∏–º—É—é –¥–ª—è –¥—Ä—É–≥–∏—Ö, –Ω–æ —Å–≤–µ—Ç—è—â—É—é—Å—è –¥–ª—è —Ç–µ–±—è –í–æ–ª—à–µ–±–Ω—É—é –ö–∏—Å—Ç—å.</p><p><i>¬´–¢—ã ‚Äî —Ö—É–¥–æ–∂–Ω–∏–∫ —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏. –¢—ã –º–æ–∂–µ—à—å —Ä–∏—Å–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –¥–µ–Ω—å —Ç–∞–∫–∏–º, –∫–∞–∫–∏–º —Ö–æ—á–µ—à—å –µ–≥–æ –≤–∏–¥–µ—Ç—å¬ª.</i></p><p><b>üßò‚Äç‚ôÄÔ∏è –ü—Ä–∞–∫—Ç–∏–∫–∞:</b> –°—è–¥—å —É–¥–æ–±–Ω–æ. –í–¥–æ—Ö–Ω–∏ –∑–æ–ª–æ—Ç–∏—Å—Ç—ã–π —Å–≤–µ—Ç. –ü—Ä–µ–¥—Å—Ç–∞–≤—å —Ö–æ–ª—Å—Ç —Å–≤–æ–µ–≥–æ –¥–Ω—è. –†–∞—Å–∫—Ä–∞—Å—å –µ–≥–æ —è—Ä–∫–∏–º–∏ –∫—Ä–∞—Å–∫–∞–º–∏!</p>`,
            adult: `<p><b>üé® –î–µ–Ω—å 1. –í–æ–ª—à–µ–±–Ω–∞—è –ö–∏—Å—Ç—å (–í–∑—Ä–æ—Å–ª—ã–µ)</b></p><p>–¢—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—à—å –≥–ª–∞–∑–∞ —É—Ç—Ä–æ–º. –ù–∞ —Å—Ç–æ–ª–∏–∫–µ –∑–∞–ø–∏—Å–∫–∞: <i>¬´–¢—ã –∑–∞–±—ã–ª, —á—Ç–æ –º–æ–∂–µ—à—å —Å–æ–∑–¥–∞–≤–∞—Ç—å. –ù–µ –≤–µ—â–∏ ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏—è. –í–æ—Ç —Ç–µ–±–µ –∫–∏—Å—Ç—å¬ª.</i></p><p><b>üßò –ü—Ä–∞–∫—Ç–∏–∫–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:</b> –ü—Ä–µ–¥—Å—Ç–∞–≤—å –æ–≥—Ä–æ–º–Ω—ã–π –±–µ–ª—ã–π —Ö–æ–ª—Å—Ç. –≠—Ç–æ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å. –ö–∞–∫–∏–º —Ü–≤–µ—Ç–æ–º —Ç—ã —Ö–æ—á–µ—à—å –µ–≥–æ –Ω–∞–ø–æ–ª–Ω–∏—Ç—å? –ö–∞–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–∂–∏—Ç—å?</p>`,
            story: `<p><b>‚ú® –≠–ª–ª–∏ –∏ –í–æ–ª—à–µ–±–Ω–∞—è –ö–∏—Å—Ç—å</b></p><p>–í –∫—Ä–∞—é, –≥–¥–µ –∑–≤—ë–∑–¥—ã —Å–ø—É—Å–∫–∞—é—Ç—Å—è –Ω–∏–∑–∫–æ-–Ω–∏–∑–∫–æ, –∂–∏–ª–∞ –¥–µ–≤–æ—á–∫–∞ –ø–æ –∏–º–µ–Ω–∏ –≠–ª–ª–∏. –£ –Ω–µ—ë –±—ã–ª —Å–µ–∫—Ä–µ—Ç. –ö–∞–∂–¥–æ–µ —É—Ç—Ä–æ –æ–Ω–∞ –Ω–∞—Ö–æ–¥–∏–ª–∞ –ø–æ–¥ –ø–æ–¥—É—à–∫–æ–π –Ω–æ–≤—É—é –∫—Ä–∞—Å–∫—É.</p><p>–ù–æ –æ–¥–Ω–∞–∂–¥—ã –∫—Ä–∞—Å–∫–∏ –∏—Å—á–µ–∑–ª–∏. –û—Å—Ç–∞–ª–∞—Å—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞, –ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è, –∫–∞–∫ –≤–æ–¥–∞. –ò —Å—Ç–∞—Ä–∞—è –∫–∏—Å—Ç–æ—á–∫–∞...</p>`
        };

        const items = [
            {n: "–í–æ–ª—à–µ–±–Ω–∞—è –ö–∏—Å—Ç—å", i: "üñåÔ∏è"}, {n: "–ó–µ—Ä–∫–∞–ª–æ –ú–µ—á—Ç—ã", i: "ü™û"}, {n: "–ö–æ–º–ø–∞—Å –ù–∞–º–µ—Ä–µ–Ω–∏–π", i: "üß≠"},
            {n: "–°—É–Ω–¥—É–∫ –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–µ–π", i: "üì¶"}, {n: "–ê–º—É–ª–µ—Ç –°–∏–ª—ã", i: "üßø"}, {n: "–í–æ–ª—à–µ–±–Ω—ã–π –ü–æ—è—Å", i: "üéóÔ∏è"},
            {n: "–©–∏—Ç –ù–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏", i: "üõ°Ô∏è"}, {n: "–ú–æ—Å—Ç –†–∞–¥–æ—Å—Ç–∏", i: "üåà"}, {n: "–õ–æ–≤–µ—Ü –ú—ã—Å–ª–µ–π", i: "üï∏Ô∏è"},
            {n: "–í–æ–ª—à–µ–±–Ω–∞—è –ö–Ω–æ–ø–∫–∞", i: "üîò"}, {n: "–†—é–∫–∑–∞–∫ –ü–æ–¥–¥–µ—Ä–∂–∫–∏", i: "üéí"}, {n: "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –°–∞–¥", i: "üå≥"},
            {n: "–°–≤–µ—Ç–æ—Ñ–æ—Ä –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏—è", i: "üö•"}, {n: "–î–æ–º–∏–∫ –°–ø–æ–∫–æ–π—Å—Ç–≤–∏—è", i: "üè†"}, {n: "–í–æ–ª—à–µ–±–Ω—ã–π –®–∞–≥", i: "üë£"},
            {n: "–í–æ–ª—à–µ–±–Ω—ã–µ –û—á–∫–∏", i: "üëì"}, {n: "–û–¥–µ—è–ª–æ –ó–∞–±–æ—Ç—ã", i: "üõå"}, {n: "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –§–æ–Ω–∞—Ä–∏–∫", i: "üî¶"},
            {n: "–í–æ–ª—à–µ–±–Ω–æ–µ –°–µ—Ä–¥—Ü–µ", i: "üíñ"}, {n: "–õ–µ—Å –¢–∏—à–∏–Ω—ã", i: "üå≤"}, {n: "–í–æ–ª–Ω–∞ –†–∞–¥–æ—Å—Ç–∏", i: "üåä"},
            {n: "–°–≤–µ—Ç–ª—è—á–æ–∫ –ó–∞–±–æ—Ç—ã", i: "ü™î"}, {n: "–í–æ–ª—à–µ–±–Ω–æ–µ –£—Ö–æ", i: "üëÇ"}, {n: "–†–µ–∫–∞ –ü—Ä–∏–Ω—è—Ç–∏—è", i: "üö£"},
            {n: "–õ–∞–º–ø–æ—á–∫–∞ –û—Å–æ–∑–Ω–∞–Ω–∏—è", i: "üí°"}, {n: "–ö—Ä—ã–ª—å—è –ú–µ—á—Ç—ã", i: "ü™Ω"}, {n: "–ö—Ä–∏—Å—Ç–∞–ª–ª –ß–µ—Å—Ç–Ω–æ—Å—Ç–∏", i: "üíé"},
            {n: "–ó–æ–ª–æ—Ç–∞—è –ù–∏—Ç—å", i: "üßµ"}, {n: "–ó–≤–µ–∑–¥–∞ –ù–∞–¥–µ–∂–¥—ã", i: "‚≠ê"}, {n: "–í–æ–ª—à–µ–±–Ω—ã–π –ö–ª—é—á", i: "üîë"}
        ];

        let currentDayNum = 1;
        let readDays = JSON.parse(localStorage.getItem('elli_progress')) || [];
        let unlockedDays = JSON.parse(localStorage.getItem('elli_access')) || [1];
        let hasFullAccess = JSON.parse(localStorage.getItem('elli_full_access')) || false;
        let targetDayToUnlock = null;
        let offerInterval;
        const OFFER_DURATION = 15 * 60 * 1000;

        function renderGrid() {
            const grid = document.getElementById('main-grid');
            grid.innerHTML = '';
            items.forEach((item, i) => {
                const dayNum = i + 1;
                const card = document.createElement('div');
                const isRead = readDays.includes(dayNum);
                const isUnlocked = (dayNum === 1) || hasFullAccess || unlockedDays.includes(dayNum);
                const prevDayRead = (dayNum === 1) || readDays.includes(dayNum - 1);
                let classes = 'day-card'; let iconHtml = `<div class="day-icon">${item.i}</div>`; let lockHtml = '';
                if (!prevDayRead) { classes += ' frozen'; lockHtml = `<div class="lock-icon" style="opacity:0.5">‚ùÑÔ∏è</div>`; }
                else if (!isUnlocked) { classes += ' locked'; lockHtml = `<div class="lock-icon">üîí</div>`; }
                else if (isRead) classes += ' completed';
                card.className = classes;
                card.innerHTML = `${lockHtml}<div style="font-size:9px; color: ${isRead ? '#d4af37' : '#aaa'}; font-weight:${isRead?'bold':'normal'};">–î–ï–ù–¨ ${dayNum}</div>${iconHtml}<div class="day-name">${item.n}</div>`;
                if (prevDayRead) { card.onclick = isUnlocked ? () => openDayMenu(dayNum, item.n) : () => showPaywall(dayNum); }
                else { card.onclick = () => showFutureWarning(); }
                grid.appendChild(card);
            });
        }
        renderGrid();

        // --- –õ–û–ì–ò–ö–ê –ö–û–ù–¢–ï–ù–¢–ê (–° –ü–û–õ–ù–´–ú–ò –°–°–´–õ–ö–ê–ú–ò) ---
        async function openContent(type) {
            // –°–Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º —ç–∫—Ä–∞–Ω, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–µ–ª —Ä–µ–∞–∫—Ü–∏—é
            switchView('view-content'); stopScroll();
            
            const els = {
                videoArea: document.getElementById('video-area'),
                videoPlayer: document.getElementById('video-player'),
                textBox: document.getElementById('text-box'),
                textDisplay: document.getElementById('text-display'),
                audioBox: document.getElementById('audio-box'),
                audioPlayer: document.getElementById('audio-player'),
                mainImage: document.getElementById('main-image'),
                scrollBtn: document.getElementById('scroll-btn'),
                status: document.getElementById('status-message')
            };

            // –°–±—Ä–æ—Å
            els.videoPlayer.pause(); els.audioPlayer.pause();
            els.videoArea.style.display = 'none'; els.textBox.style.display = 'none'; 
            els.audioBox.style.display = 'none'; els.mainImage.style.display = 'none';
            els.scrollBtn.classList.remove('visible'); els.textDisplay.innerHTML = "";
            els.status.style.display = 'block'; els.status.innerText = "–ó–∞–≥—Ä—É–∑–∫–∞...";

            try {
                if (type === 'story') {
                    document.getElementById('header-title').innerText = "üìñ –ò—Å—Ç–æ—Ä–∏—è";
                    await loadTextContent(`texts/day${currentDayNum}_story.html`, 'story');
                    els.audioBox.style.display = 'block'; 
                    document.getElementById('audio-title').innerText = "üéß –°–ª—É—à–∞—Ç—å —Å–∫–∞–∑–∫—É";
                    els.audioPlayer.src = `${BASE_URL}audio/day${currentDayNum}_story.mp3`; 
                    els.scrollBtn.classList.add('visible');

                } else if (type === 'video') {
                    document.getElementById('header-title').innerText = "üé¨ –í–∏–¥–µ–æ";
                    els.status.style.display = 'none';
                    els.videoArea.style.display = 'block'; 
                    els.videoPlayer.src = `${BASE_URL}videos/day${currentDayNum}.mp4`;

                } else if (type === 'song') {
                    document.getElementById('header-title').innerText = "üéµ –ü–µ—Å–µ–Ω–∫–∞";
                    els.status.style.display = 'none';
                    els.mainImage.src = `${BASE_URL}images/day${currentDayNum}.jpg`; 
                    els.mainImage.style.display = 'block';
                    els.audioBox.style.display = 'block'; 
                    document.getElementById('audio-title').innerText = "üéß –°–ª—É—à–∞—Ç—å –ø–µ—Å–µ–Ω–∫—É";
                    els.audioPlayer.src = `${BASE_URL}audio/day${currentDayNum}_song.mp3`;

                } else if (type === 'child') {
                    document.getElementById('header-title').innerText = "üë∂ –ü—Ä–∞–∫—Ç–∏–∫–∞ (–î–µ—Ç–∏)";
                    await loadTextContent(`texts/day${currentDayNum}_child.html`, 'child');
                    els.audioBox.style.display = 'block'; 
                    document.getElementById('audio-title').innerText = "üéß –°–ª—É—à–∞—Ç—å –ø—Ä–∞–∫—Ç–∏–∫—É";
                    els.audioPlayer.src = `${BASE_URL}audio/day${currentDayNum}_child.mp3`; 
                    els.scrollBtn.classList.add('visible');

                } else if (type === 'adult') {
                    document.getElementById('header-title').innerText = "üßò‚Äç‚ôÄÔ∏è –ü—Ä–∞–∫—Ç–∏–∫–∞ (–í–∑—Ä)";
                    await loadTextContent(`texts/day${currentDayNum}_adult.html`, 'adult');
                    els.audioBox.style.display = 'block'; 
                    document.getElementById('audio-title').innerText = "üéß –°–ª—É—à–∞—Ç—å –ø—Ä–∞–∫—Ç–∏–∫—É";
                    els.audioPlayer.src = `${BASE_URL}audio/day${currentDayNum}_adult.mp3`; 
                    els.scrollBtn.classList.add('visible');
                }
                
                if (els.audioBox.style.display === 'block') els.audioPlayer.load();

            } catch (err) {
                // –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∞ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ
                alert("–û—à–∏–±–∫–∞: " + err.message);
                els.status.innerText = "–û—à–∏–±–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è";
            }
        }

        async function loadTextContent(relativePath, typeKey) {
            const textBox = document.getElementById('text-box');
            const textDisplay = document.getElementById('text-display');
            const status = document.getElementById('status-message');

            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º BASE_URL –¥–ª—è –∂–µ—Å—Ç–∫–æ–π –ø—Ä–∏–≤—è–∑–∫–∏
                const res = await fetch(BASE_URL + relativePath);
                if (res.ok) {
                    let text = await res.text();
                    textDisplay.innerHTML = formatText(text, currentDayNum);
                    textBox.style.display = 'block';
                    status.style.display = 'none';
                } else {
                    throw new Error("–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω");
                }
            } catch (e) {
                // –ï—Å–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å - –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
                if (currentDayNum === 1 && day1_backup[typeKey]) {
                    textDisplay.innerHTML = formatText(day1_backup[typeKey], 1);
                    textBox.style.display = 'block';
                    status.style.display = 'none';
                } else {
                    status.innerText = "–¢–µ–∫—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.";
                    status.style.display = 'block';
                }
            }
        }

        // --- –°–ò–°–¢–ï–ú–ù–´–ï –§–£–ù–ö–¶–ò–ò ---
        function showFutureWarning() {
            const nextStep = items.findIndex((_, i) => !readDays.includes(i+1)) + 1;
            document.getElementById('modal-icon').innerText = "‚è≥";
            document.getElementById('modal-title').innerText = "–ù–µ —Å–ø–µ—à–∏!";
            document.getElementById('modal-text').innerHTML = `–ü—Ä–æ–π–¥–∏ —Å–Ω–∞—á–∞–ª–∞ –î–µ–Ω—å ${nextStep}!`;
            document.getElementById('access-code').style.display = 'none';
            document.getElementById('btn-secondary-action').style.display = 'none';
            const btn = document.getElementById('btn-main-action');
            btn.innerText = "–•–æ—Ä–æ—à–æ"; btn.onclick = () => { document.getElementById('paywall-modal').style.display = 'none'; }; 
            document.getElementById('paywall-modal').style.display = 'flex';
        }
        function showPaywall(dayNum) {
            targetDayToUnlock = dayNum;
            document.getElementById('modal-icon').innerText = "üîí";
            document.getElementById('modal-title').innerText = `–û—Ç–∫—Ä—ã—Ç—å –î–µ–Ω—å ${dayNum}`;
            document.getElementById('modal-text').innerText = "–í–≤–µ–¥–∏ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞:";
            document.getElementById('access-code').style.display = 'block';
            document.getElementById('access-code').value = '';
            document.getElementById('btn-secondary-action').style.display = 'block';
            const btn = document.getElementById('btn-main-action');
            btn.innerText = "‚ú® –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å"; btn.onclick = checkCode;
            document.getElementById('paywall-modal').style.display = 'flex';
        }
        function openSpecialOffer() {
            document.getElementById('paywall-modal').style.display = 'none';
            document.getElementById('offer-modal').style.display = 'flex';
            const dayNum = targetDayToUnlock ? targetDayToUnlock : "...";
            const labelText = `–î–æ—Å—Ç—É–ø –∫ –î–Ω—é ${dayNum}`;
            document.getElementById('single-day-label').innerText = labelText;
            document.getElementById('expired-single-label').innerText = labelText;
            let startTime = localStorage.getItem('elli_offer_start');
            if (!startTime) { startTime = Date.now(); localStorage.setItem('elli_offer_start', startTime); }
            updateTimerUI(startTime);
            if (offerInterval) clearInterval(offerInterval);
            offerInterval = setInterval(() => updateTimerUI(startTime), 1000);
        }
        function updateTimerUI(startTime) {
            const now = Date.now();
            const elapsed = now - parseInt(startTime);
            const remaining = OFFER_DURATION - elapsed;
            if (remaining > 0) {
                document.getElementById('offer-content-active').style.display = 'block';
                document.getElementById('offer-content-expired').style.display = 'none';
                const minutes = Math.floor(remaining / 60000);
                const seconds = Math.floor((remaining % 60000) / 1000);
                document.getElementById('timer-display').innerText = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            } else {
                clearInterval(offerInterval);
                document.getElementById('offer-content-active').style.display = 'none';
                document.getElementById('offer-content-expired').style.display = 'block';
            }
        }
        function goToTelegram(type) {
            const baseUrl = "https://t.me/golokagid"; let text = ""; let dayNum = targetDayToUnlock || "...";
            if (type === 'full_discount') text = "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –•–æ—á—É –∫—É–ø–∏—Ç—å –ü–û–õ–ù–´–ô –î–û–°–¢–£–ü –°–û –°–ö–ò–î–ö–û–ô –∑–∞ 3000 —Ä—É–±";
            else if (type === 'single_discount') text = `–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –•–æ—á—É –∫—É–ø–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –î–Ω—é ${dayNum} –∑–∞ 100 —Ä—É–± (—Å–æ —Å–∫–∏–¥–∫–æ–π)`;
            else if (type === 'full_price') text = "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –•–æ—á—É –∫—É–ø–∏—Ç—å –ü–û–õ–ù–´–ô –î–û–°–¢–£–ü –∑–∞ 30000 —Ä—É–±";
            else if (type === 'single_price') text = `–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –•–æ—á—É –∫—É–ø–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –î–Ω—é ${dayNum} –∑–∞ 1000 —Ä—É–±`;
            window.open(`${baseUrl}?text=${encodeURIComponent(text)}`, '_blank');
        }
        function closeOffer() { document.getElementById('offer-modal').style.display = 'none'; clearInterval(offerInterval); openDonateModal(); }
        function closePaywall() { document.getElementById('paywall-modal').style.display = 'none'; if (targetDayToUnlock) openDonateModal(); targetDayToUnlock = null; }
        function openDonateModal() { document.getElementById('donate-step-1').style.display = 'block'; document.getElementById('donate-step-2').style.display = 'none'; document.getElementById('donate-modal').style.display = 'flex'; }
        function closeDonate() { document.getElementById('donate-modal').style.display = 'none'; }
        function showDonateInfo() { document.getElementById('donate-step-1').style.display = 'none'; document.getElementById('donate-step-2').style.display = 'block'; }
        function resetTimer() { localStorage.removeItem('elli_offer_start'); alert("–¢–∞–π–º–µ—Ä —Å–±—Ä–æ—à–µ–Ω!"); closeOffer(); }
        async function checkCode() {
            const input = document.getElementById('access-code'); const code = input.value.trim().toUpperCase();
            if (!code) { alert("–í–≤–µ–¥–∏ –∫–æ–¥!"); return; }
            try {
                const res = await fetch(BASE_URL + 'codes.json'); const codes = await res.json();
                if (codes[code]) {
                    if (codes[code] === 'full') activateFullAccess();
                    else if (codes[code] == targetDayToUnlock) activateSingleDay(targetDayToUnlock);
                    else alert("–ö–æ–¥ –æ—Ç –¥—Ä—É–≥–æ–≥–æ –¥–Ω—è!");
                } else alert("–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ üòî");
            } catch (e) { alert("–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–¥–∞"); }
        }
        function activateSingleDay(day) { if (!unlockedDays.includes(day)) { unlockedDays.push(day); localStorage.setItem('elli_access', JSON.stringify(unlockedDays)); } alert("‚ú® –î–µ–Ω—å –æ—Ç–∫—Ä—ã—Ç!"); document.getElementById('paywall-modal').style.display = 'none'; renderGrid(); openDayMenu(day, items[day-1].n); }
        function activateFullAccess() { hasFullAccess = true; localStorage.setItem('elli_full_access', JSON.stringify(true)); alert("‚ú® –í—Å–µ –¥–Ω–∏ –æ—Ç–∫—Ä—ã—Ç—ã!"); document.getElementById('paywall-modal').style.display = 'none'; renderGrid(); }
        function resetApp() { if(confirm("–°–±—Ä–æ—Å–∏—Ç—å?")) { localStorage.clear(); location.reload(); } }
        function openDayMenu(num, name) { currentDayNum = num; switchView('view-menu'); document.getElementById('menu-title').innerText = `–î–µ–Ω—å ${num}: ${name}`; if (!readDays.includes(num)) { readDays.push(num); localStorage.setItem('elli_progress', JSON.stringify(readDays)); renderGrid(); } }
        function switchView(viewId) { document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active-view')); document.getElementById(viewId).classList.add('active-view'); }
        function formatText(text, dayNum) {
            if (!text) return "";
            // –ó–∞–º–µ–Ω–∞ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤ –∫–∞—Ä—Ç–∏–Ω–æ–∫ –Ω–∞ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏
            let html = text.replace(/\[IMAGE(\d*)\]/g, (match, p1) => { const suffix = p1 ? `_${p1}` : ''; return `<img src="${BASE_URL}images/day${dayNum}${suffix}.jpg" class="book-media" onerror="this.style.display='none'">`; });
            html = html.replace(/\[GIF(\d*)\]/g, (match, p1) => { const suffix = p1 ? `_${p1}` : ''; return `<img src="${BASE_URL}images/day${dayNum}${suffix}.gif" class="book-media" onerror="this.style.display='none'">`; });
            return html;
        }
        function goBackToMenu() { document.getElementById('audio-player').pause(); document.getElementById('video-player').pause(); switchView('view-menu'); }
        function goHome() { document.getElementById('audio-player').pause(); document.getElementById('video-player').pause(); switchView('view-grid'); }
        function toggleAutoScroll() { const container = document.getElementById('scroll-box'); const btn = document.getElementById('scroll-btn'); if (isScrolling) { clearInterval(scrollInterval); btn.classList.remove('active'); } else { scrollInterval = setInterval(() => { container.scrollTop += 1; if (container.scrollTop + container.clientHeight >= container.scrollHeight - 2) stopScroll(); }, 35); btn.classList.add('active'); } isScrolling = !isScrolling; }
        function stopScroll() { clearInterval(scrollInterval); isScrolling = false; const btn = document.getElementById('scroll-btn'); if(btn) btn.classList.remove('active'); }
        const tg = window.Telegram.WebApp; tg.ready(); tg.expand(); tg.setHeaderColor('#fdfbf7'); tg.setBackgroundColor('#fdfbf7');
        tg.BackButton.onClick(() => { if (document.getElementById('view-menu').classList.contains('active-view')) goHome(); else if (document.getElementById('view-content').classList.contains('active-view')) goBackToMenu(); });
        setInterval(() => { if (document.getElementById('view-grid').classList.contains('active-view')) tg.BackButton.hide(); else tg.BackButton.show(); }, 200);
    </script>
</body>
</html>
