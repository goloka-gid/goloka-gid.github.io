<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∏—Ä –≠–ª–ª–∏</title>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;700&family=Lora:ital,wght@0,400;1,500&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #fdfbf7 0%, #e8e3f5 100%);
            --accent: #9b87f5;
            --text-color: #4a4a6a;
        }

        body {
            font-family: 'Comfortaa', cursive;
            background: var(--bg-gradient);
            background-attachment: fixed;
            color: var(--text-color);
            margin: 0; padding: 20px;
            min-height: 100vh;
        }

        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; max-width: 500px; margin: 0 auto; }
        
        .day-card {
            background: rgba(255,255,255,0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px; padding: 15px 5px; text-align: center;
            box-shadow: 0 8px 20px rgba(155, 135, 245, 0.2);
            border: 1px solid white; transition: 0.3s;
        }

        /* –°—Ç–∏–ª—å —Å–∫–∞–∑–æ—á–Ω–æ–π –∫–Ω–∏–≥–∏ */
        #content-page {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-gradient); z-index: 1000; overflow: hidden;
        }

        .scroll-container {
            height: 100%; overflow-y: auto; scroll-behavior: smooth;
            padding: 20px; padding-bottom: 200px;
        }

        /* –û–±—ä–µ–º–Ω—ã–π —Ç–µ–∫—Å—Ç –∏—Å—Ç–æ—Ä–∏–∏ */
        .magic-text {
            font-family: 'Lora', serif;
            font-size: 19px;
            line-height: 1.8;
            color: #4a3b6d;
            text-shadow: 1px 1px 0px rgba(255,255,255,0.8), 2px 2px 4px rgba(155, 135, 245, 0.15); /* –≠—Ñ—Ñ–µ–∫—Ç –æ–±—ä–µ–º–∞ */
            white-space: pre-wrap;
            margin-top: 40px;
        }

        .section-box {
            background: rgba(255,255,255,0.6);
            border-radius: 25px; padding: 20px; margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.8);
        }

        /* –ö–Ω–æ–ø–∫–∞ –º–∞–≥–∏–∏ */
        .magic-scroll-btn {
            background: white; border: none; padding: 10px 20px;
            border-radius: 50px; color: var(--accent); font-weight: bold;
            box-shadow: 0 4px 15px var(--accent); margin: 10px 0;
            cursor: pointer; display: block; width: fit-content; margin-left: auto;
        }

        .back-btn { background: none; border: none; font-size: 24px; cursor: pointer; }
    </style>
</head>
<body>

    <div id="main-view">
        <h1 style="text-align: center; color: #7c67d6;">‚ú® –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≠–ª–ª–∏</h1>
        <div class="grid" id="main-grid"></div>
    </div>

    <div id="content-page">
        <div class="scroll-container" id="scroll-box">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <button class="back-btn" onclick="closeDay()">üîô</button>
                <button class="magic-scroll-btn" id="scroll-btn" onclick="toggleAutoScroll()">‚ú® –ù–∞—á–∞—Ç—å —á—Ç–µ–Ω–∏–µ</button>
            </div>
            
            <h2 id="title-label" style="text-align: center; color: var(--accent);"></h2>

            <div class="section-box">
                <div id="story-display" class="magic-text"></div>
            </div>

            <div class="section-box">
                <h3 style="color: var(--accent);">üéµ –°–ª—É—à–∞—Ç—å –∞—É–¥–∏–æ</h3>
                <audio id="audio-player" controls style="width: 100%;"></audio>
            </div>
            
            <div class="section-box">
                <h3 style="color: var(--accent);">üßò –ü—Ä–∞–∫—Ç–∏–∫–∞</h3>
                <div id="practice-display" class="magic-text" style="font-size: 16px;"></div>
            </div>
        </div>
    </div>

    <script>
        const items = [
            {n: "–í–æ–ª—à–µ–±–Ω–∞—è –ö–∏—Å—Ç—å", i: "üñåÔ∏è"}, {n: "–ó–µ—Ä–∫–∞–ª–æ –ú–µ—á—Ç—ã", i: "ü™û"}, {n: "–ö–æ–º–ø–∞—Å –ù–∞–º–µ—Ä–µ–Ω–∏–π", i: "üß≠"},
            {n: "–°—É–Ω–¥—É–∫ –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–µ–π", i: "üì¶"}, {n: "–ê–º—É–ª–µ—Ç –°–∏–ª—ã", i: "üßø"}, {n: "–í–æ–ª—à–µ–±–Ω—ã–π –ü–æ—è—Å", i: "üéóÔ∏è"}
        ];

        let isScrolling = false;
        let scrollInterval;

        const grid = document.getElementById('main-grid');
        items.forEach((item, i) => {
            const card = document.createElement('div');
            card.className = 'day-card';
            card.innerHTML = `<div style="font-size:10px">–î–ï–ù–¨ ${i+1}</div><div style="font-size:30px">${item.i}</div><div style="font-size:12px; font-weight:bold">${item.n}</div>`;
            card.onclick = () => openDay(i + 1, item.n);
            grid.appendChild(card);
        });

        async function openDay(num, name) {
            document.getElementById('title-label').innerText = name;
            document.getElementById('audio-player').src = `audio/day${num}_story.mp3`;
            
            try {
                const res = await fetch(`texts/day${num}.json`);
                const data = await res.json();
                document.getElementById('story-display').innerText = data.story;
                // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ç—Å–∫—É—é –ø—Ä–∞–∫—Ç–∏–∫—É, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ (–∏–ª–∏ –æ–±–µ)
                document.getElementById('practice-display').innerText = data.child + "\n\n" + data.adult;
            } catch (e) {
                document.getElementById('story-display').innerText = "–ò—Å—Ç–æ—Ä–∏—è —Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è...";
            }

            document.getElementById('content-page').style.display = 'block';
            document.getElementById('main-view').style.display = 'none';
        }

        function toggleAutoScroll() {
            const container = document.getElementById('scroll-box');
            const btn = document.getElementById('scroll-btn');
            
            if (isScrolling) {
                clearInterval(scrollInterval);
                btn.innerText = "‚ú® –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —á—Ç–µ–Ω–∏–µ";
            } else {
                scrollInterval = setInterval(() => {
                    container.scrollTop += 1; // –°–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
                    if (container.scrollTop + container.clientHeight >= container.scrollHeight) {
                        clearInterval(scrollInterval);
                    }
                }, 50); // –ü–ª–∞–≤–Ω–æ—Å—Ç—å (—á–µ–º –º–µ–Ω—å—à–µ —á–∏—Å–ª–æ, —Ç–µ–º –±—ã—Å—Ç—Ä–µ–µ)
                btn.innerText = "‚è∏ –ü–∞—É–∑–∞";
            }
            isScrolling = !isScrolling;
        }

        function closeDay() {
            clearInterval(scrollInterval);
            isScrolling = false;
            document.getElementById('audio-player').pause();
            document.getElementById('content-page').style.display = 'none';
            document.getElementById('main-view').style.display = 'block';
        }
    </script>
</body>
</html>
