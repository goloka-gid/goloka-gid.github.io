<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ú–∏—Ä –≠–ª–ª–∏</title>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;700&family=Lora:ital,wght@0,400;1,500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

    <div id="view-grid" class="view-section active-view">
        <h1>‚ú® –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≠–ª–ª–∏</h1>
        <p style="text-align:center; font-size:10px; opacity:0.3;" onclick="resetApp()">[–°–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫]</p>
        <div class="grid" id="main-grid"></div>
    </div>

    <div id="offer-modal" class="modal-overlay">
        <div class="modal-card">
            <button class="btn-close" onclick="closeModal()">‚úñ</button>
            <div style="font-size:40px; margin-bottom:10px">üéÅ</div>
            <h3 style="margin:0 0 10px 0">–û—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø?</h3>
            <p style="font-size:13px; color:#666; margin-bottom:20px;">–ü–µ—Ä–≤—ã–µ 2 –¥–Ω—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ. –î–∞–ª—å—à–µ –Ω—É–∂–Ω–æ –Ω–µ–º–Ω–æ–≥–æ –≤–æ–ª—à–µ–±—Å—Ç–≤–∞ ‚ú®</p>
            
            <div class="pricing-card highlight">
                <div style="font-size:12px; color:#ff4757; font-weight:bold">–°–∫–∏–¥–∫–∞ 90%</div>
                <div class="price-row">
                    <span class="old-price">30000 ‚ÇΩ</span>
                    <span class="new-price red">3000 ‚ÇΩ</span>
                </div>
                <button class="btn-action btn-discount" onclick="buy('full')">–ö—É–ø–∏—Ç—å –í–°–Å —Å—Ä–∞–∑—É</button>
            </div>

            <div class="pricing-card">
                <div style="font-size:12px; color:#555">–û–¥–∏–Ω –¥–µ–Ω—å</div>
                <div class="price-row">
                    <span class="old-price">1000 ‚ÇΩ</span>
                    <span class="new-price">100 ‚ÇΩ</span>
                </div>
                <button class="btn-action btn-secondary" onclick="buy('day')">–ö—É–ø–∏—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å</button>
            </div>
        </div>
    </div>

    <div id="view-menu" class="view-section">
        <button class="simple-back" onclick="goHome()">‚¨Ö –ö –∫–∞—Ä—Ç–µ –¥–Ω–µ–π</button>
        <h2 id="menu-title" style="margin-top: 0;"></h2>
        <div class="menu-container">
            <div class="menu-btn" onclick="openContent('story')"><span class="menu-icon">üìñ</span><div><div style="font-weight:bold">–°–∫–∞–∑–æ—á–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è</div><div style="font-size:11px; opacity:0.7">–ß–∏—Ç–∞—Ç—å –∏ —Å–ª—É—à–∞—Ç—å</div></div></div>
            <div class="menu-btn" onclick="openContent('video')"><span class="menu-icon">üé¨</span><div><div style="font-weight:bold">–°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ</div><div style="font-size:11px; opacity:0.7">–í–æ–ª—à–µ–±–Ω—ã–π –º—É–ª—å—Ç—Ñ–∏–ª—å–º</div></div></div>
            <div class="menu-btn" onclick="openContent('song')"><span class="menu-icon">üéµ</span><div><div style="font-weight:bold">–ü–µ—Å–µ–Ω–∫–∞ –¥–Ω—è</div><div style="font-size:11px; opacity:0.7">–¢–∞–Ω—Ü—É–π –∏ –ø–æ–π</div></div></div>
            <div class="menu-btn" onclick="openContent('child')"><span class="menu-icon">üë∂</span><div><div style="font-weight:bold">–ü—Ä–∞–∫—Ç–∏–∫–∞ –¥–ª—è –¥–µ—Ç–µ–π</div><div style="font-size:11px; opacity:0.7">–¥–æ 15 –ª–µ—Ç</div></div></div>
            <div class="menu-btn" onclick="openContent('adult')"><span class="menu-icon">üßò‚Äç‚ôÄÔ∏è</span><div><div style="font-weight:bold">–í–∑—Ä–æ—Å–ª–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞</div><div style="font-size:11px; opacity:0.7">–û—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç—å –¥–ª—è —Ç–µ–±—è</div></div></div>
        </div>
    </div>

    <div id="view-content" class="view-section">
        <div class="header-fixed">
            <button class="nav-btn" onclick="goHome()">üè† –î–Ω–∏</button>
            <span id="header-title" style="font-size:12px; font-weight:bold; max-width: 120px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"></span>
            <button class="nav-btn" onclick="goBackToMenu()">üîô –ú–µ–Ω—é</button>
        </div>
        <div class="scroll-wrapper" id="scroll-box">
            <div style="padding: 15px;">
                <div id="video-area" style="display:none;">
                    <div class="section-box" style="text-align: center;">
                        <h3 style="color: var(--accent); margin:0 0 10px 0;">üé¨ –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞!</h3>
                        <div class="video-wrapper"><video id="video-player" controls playsinline></video></div>
                    </div>
                </div>
                <img id="main-image" src="" class="book-media" style="display:none;" onerror="this.style.display='none'">
                <div class="section-box" id="text-box" style="display:none;"><div id="text-display" class="magic-text"></div></div>
                <div class="section-box" id="audio-box" style="display:none;"><h3 id="audio-title" style="color: var(--accent); margin-top:0; font-size: 16px;">üéß –°–ª—É—à–∞—Ç—å</h3><audio id="audio-player" controls></audio></div>
            </div>
        </div>
        <button class="fab-scroll" id="scroll-btn" onclick="toggleAutoScroll()">‚ú®</button>
    </div>

    <script>
        // –í—à–∏—Ç—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ —Ä–∞–±–æ—Ç—ã –î–µ–Ω—å 1
        const day1_texts = {
            story: `<p><b>‚ú® –≠–ª–ª–∏ –∏ –í–æ–ª—à–µ–±–Ω–∞—è –ö–∏—Å—Ç—å</b></p><p>–í –∫—Ä–∞—é, –≥–¥–µ –∑–≤—ë–∑–¥—ã —Å–ø—É—Å–∫–∞—é—Ç—Å—è –Ω–∏–∑–∫–æ-–Ω–∏–∑–∫–æ, –∂–∏–ª–∞ –¥–µ–≤–æ—á–∫–∞ –ø–æ –∏–º–µ–Ω–∏ –≠–ª–ª–∏. –£ –Ω–µ—ë –±—ã–ª —Å–µ–∫—Ä–µ—Ç. –ö–∞–∂–¥–æ–µ —É—Ç—Ä–æ –æ–Ω–∞ –Ω–∞—Ö–æ–¥–∏–ª–∞ –ø–æ–¥ –ø–æ–¥—É—à–∫–æ–π –Ω–æ–≤—É—é –∫—Ä–∞—Å–∫—É.</p><p>–ù–æ –æ–¥–Ω–∞–∂–¥—ã –∫—Ä–∞—Å–∫–∏ –∏—Å—á–µ–∑–ª–∏. –û—Å—Ç–∞–ª–∞—Å—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞, –ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è, –∫–∞–∫ –≤–æ–¥–∞. –ò —Å—Ç–∞—Ä–∞—è –∫–∏—Å—Ç–æ—á–∫–∞.</p>`,
            child: `<p style="text-align: center;"><b>üé® –î–µ–Ω—å 1. –í–æ–ª—à–µ–±–Ω–∞—è –ö–∏—Å—Ç—å</b></p><p><b>‚ú® –¢–≤–æ—è –ò—Å—Ç–æ—Ä–∏—è</b></p><p>–ü—Ä–µ–¥—Å—Ç–∞–≤—å: —Ç—ã –ø—Ä–æ—Å—ã–ø–∞–µ—à—å—Å—è —É—Ç—Ä–æ–º... (—Ç–µ–∫—Å—Ç –∑–∞–≥—Ä—É–∂–µ–Ω)</p>`,
            adult: `<p style="text-align: center;"><b>üé® –î–µ–Ω—å 1. –í–æ–ª—à–µ–±–Ω–∞—è –ö–∏—Å—Ç—å (–í–∑—Ä–æ—Å–ª—ã–µ)</b></p><p><b>‚ú® –¢–≤–æ—è –ò—Å—Ç–æ—Ä–∏—è</b></p><p>–¢—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—à—å –≥–ª–∞–∑–∞ —É—Ç—Ä–æ–º... (—Ç–µ–∫—Å—Ç –∑–∞–≥—Ä—É–∂–µ–Ω)</p>`
        };

        const items = [
            {n: "–í–æ–ª—à–µ–±–Ω–∞—è –ö–∏—Å—Ç—å", i: "üñåÔ∏è"}, {n: "–ó–µ—Ä–∫–∞–ª–æ –ú–µ—á—Ç—ã", i: "ü™û"}, {n: "–ö–æ–º–ø–∞—Å –ù–∞–º–µ—Ä–µ–Ω–∏–π", i: "üß≠"},
            {n: "–°—É–Ω–¥—É–∫ –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–µ–π", i: "üì¶"}, {n: "–ê–º—É–ª–µ—Ç –°–∏–ª—ã", i: "üßø"}, {n: "–í–æ–ª—à–µ–±–Ω—ã–π –ü–æ—è—Å", i: "üéóÔ∏è"},
            {n: "–©–∏—Ç –ù–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏", i: "üõ°Ô∏è"}, {n: "–ú–æ—Å—Ç –†–∞–¥–æ—Å—Ç–∏", i: "üåà"}, {n: "–õ–æ–≤–µ—Ü –ú—ã—Å–ª–µ–π", i: "üï∏Ô∏è"},
            {n: "–í–æ–ª—à–µ–±–Ω–∞—è –ö–Ω–æ–ø–∫–∞", i: "üîò"}, {n: "–†—é–∫–∑–∞–∫ –ü–æ–¥–¥–µ—Ä–∂–∫–∏", i: "üéí"}, {n: "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –°–∞–¥", i: "üå≥"},
            {n: "–°–≤–µ—Ç–æ—Ñ–æ—Ä –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏—è", i: "üö•"}, {n: "–î–æ–º–∏–∫ –°–ø–æ–∫–æ–π—Å—Ç–≤–∏—è", i: "üè†"}, {n: "–í–æ–ª—à–µ–±–Ω—ã–π –®–∞–≥", i: "üë£"},
            {n: "–í–æ–ª—à–µ–±–Ω—ã–µ –û—á–∫–∏", i: "üëì"}, {n: "–û–¥–µ—è–ª–æ –ó–∞–±–æ—Ç—ã", i: "üõå"}, {n: "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –§–æ–Ω–∞—Ä–∏–∫", i: "üî¶"},
            {n: "–í–æ–ª—à–µ–±–Ω–æ–µ –°–µ—Ä–¥—Ü–µ", i: "üíñ"}, {n: "–õ–µ—Å –¢–∏—à–∏–Ω—ã", i: "üå≤"}, {n: "–í–æ–ª–Ω–∞ –†–∞–¥–æ—Å—Ç–∏", i: "üåä"},
            {n: "–°–≤–µ—Ç–ª—è—á–æ–∫ –ó–∞–±–æ—Ç—ã", i: "ü™î"}, {n: "–í–æ–ª—à–µ–±–Ω–æ–µ –£—Ö–æ", i: "üëÇ"}, {n: "–†–µ–∫–∞ –ü—Ä–∏–Ω—è—Ç–∏—è", i: "üö£"},
            {n: "–õ–∞–º–ø–æ—á–∫–∞ –û—Å–æ–∑–Ω–∞–Ω–∏—è", i: "üí°"}, {n: "–ö—Ä—ã–ª—å—è –ú–µ—á—Ç—ã", i: "ü™Ω"}, {n: "–ö—Ä–∏—Å—Ç–∞–ª–ª –ß–µ—Å—Ç–Ω–æ—Å—Ç–∏", i: "üíé"},
            {n: "–ó–æ–ª–æ—Ç–∞—è –ù–∏—Ç—å", i: "üßµ"}, {n: "–ó–≤–µ–∑–¥–∞ –ù–∞–¥–µ–∂–¥—ã", i: "‚≠ê"}, {n: "–í–æ–ª—à–µ–±–Ω—ã–π –ö–ª—é—á", i: "üîë"}
        ];

        let currentDayNum = 1;
        let readDays = JSON.parse(localStorage.getItem('elli_progress')) || [];
        let unlockedDays = JSON.parse(localStorage.getItem('elli_access')) || [1, 2];
        let targetDayToUnlock = null;

        // --- 1. –°–ï–¢–ö–ê (–° –ó–ê–ú–ö–ê–ú–ò) ---
        function renderGrid() {
            const grid = document.getElementById('main-grid');
            grid.innerHTML = '';
            items.forEach((item, i) => {
                const dayNum = i + 1;
                const card = document.createElement('div');
                const isRead = readDays.includes(dayNum);
                
                // –õ–û–ì–ò–ö–ê: 1 –∏ 2 –æ—Ç–∫—Ä—ã—Ç—ã –≤—Å–µ–≥–¥–∞
                const isUnlocked = (dayNum <= 2) || unlockedDays.includes(dayNum);
                
                let classes = 'day-card';
                if (isRead) classes += ' completed';
                card.className = classes;
                
                // –ó–∞–º–æ–∫
                let lockHtml = !isUnlocked ? `<div class="lock-icon">üîí</div>` : '';
                
                card.innerHTML = `
                    ${lockHtml}
                    <div style="font-size:9px; color: ${isRead ? '#d4af37' : '#aaa'}; font-weight:${isRead?'bold':'normal'};">–î–ï–ù–¨ ${dayNum}</div>
                    <div class="day-icon">${item.i}</div>
                    <div class="day-name">${item.n}</div>
                `;
                
                if (isUnlocked) {
                    card.onclick = () => openDayMenu(dayNum, item.n);
                } else {
                    card.onclick = () => showModal(dayNum);
                }
                
                grid.appendChild(card);
            });
        }
        renderGrid();

        // --- 2. –ú–û–î–ê–õ–ö–ê ---
        function showModal(dayNum) {
            targetDayToUnlock = dayNum;
            document.getElementById('offer-modal').style.display = 'flex';
        }
        function closeModal() {
            document.getElementById('offer-modal').style.display = 'none';
        }
        function buy(type) {
            const text = type === 'full' ? "–•–æ—á—É –∫—É–ø–∏—Ç—å –ü–û–õ–ù–´–ô –î–û–°–¢–£–ü –∑–∞ 3000 —Ä—É–±" : "–•–æ—á—É –∫—É–ø–∏—Ç—å –¥–æ—Å—Ç—É–ø –∑–∞ 100 —Ä—É–±";
            window.open(`https://t.me/golokagid?text=${encodeURIComponent(text)}`, '_blank');
        }

        // --- 3. –ù–ê–í–ò–ì–ê–¶–ò–Ø (–¢–í–û–Ø –°–¢–ê–†–ê–Ø) ---
        function openDayMenu(num, name) {
            currentDayNum = num;
            switchView('view-menu');
            document.getElementById('menu-title').innerText = `–î–µ–Ω—å ${num}: ${name}`;
            if (!readDays.includes(num)) {
                readDays.push(num);
                localStorage.setItem('elli_progress', JSON.stringify(readDays));
                renderGrid();
            }
        }

        // --- 4. –ö–û–ù–¢–ï–ù–¢ (–ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô) ---
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç, –µ—Å–ª–∏ —ç—Ç–æ –î–µ–Ω—å 1
        async function openContent(type) {
            switchView('view-content');
            stopScroll(); 
            
            const videoArea = document.getElementById('video-area');
            const videoPlayer = document.getElementById('video-player');
            const textBox = document.getElementById('text-box');
            const textDisplay = document.getElementById('text-display');
            const audioBox = document.getElementById('audio-box');
            const audioPlayer = document.getElementById('audio-player');
            const mainImage = document.getElementById('main-image');
            const scrollBtn = document.getElementById('scroll-btn');
            const titleLabel = document.getElementById('header-title');

            // –°–±—Ä–æ—Å
            videoPlayer.pause(); audioPlayer.pause();
            videoArea.style.display = 'none'; textBox.style.display = 'none';
            audioBox.style.display = 'none'; mainImage.style.display = 'none';
            scrollBtn.classList.remove('visible'); textDisplay.innerHTML = ""; 

            // –ì–ê–†–ê–ù–¢–ò–Ø –ö–û–ù–¢–ï–ù–¢–ê –î–õ–Ø –î–ù–Ø 1
            if (currentDayNum === 1) {
                if (type === 'story') {
                    titleLabel.innerText = "üìñ –ò—Å—Ç–æ—Ä–∏—è";
                    textDisplay.innerHTML = day1_texts.story; // –ë–µ—Ä–µ–º –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
                    textBox.style.display = 'block';
                    audioBox.style.display = 'block'; 
                    audioPlayer.src = `https://goloka-gid.github.io/audio/day1_story.mp3`; // –ü–æ–ª–Ω—ã–π –ø—É—Ç—å
                    scrollBtn.classList.add('visible');
                } 
                else if (type === 'video') {
                    titleLabel.innerText = "üé¨ –í–∏–¥–µ–æ";
                    videoArea.style.display = 'block'; 
                    videoPlayer.src = `https://goloka-gid.github.io/videos/day1.mp4`; // –ü–æ–ª–Ω—ã–π –ø—É—Ç—å
                } 
                else if (type === 'song') {
                    titleLabel.innerText = "üéµ –ü–µ—Å–µ–Ω–∫–∞";
                    mainImage.src = `https://goloka-gid.github.io/images/day1.jpg`; // –ü–æ–ª–Ω—ã–π –ø—É—Ç—å
                    mainImage.style.display = 'block';
                    audioBox.style.display = 'block'; 
                    audioPlayer.src = `https://goloka-gid.github.io/audio/day1_song.mp3`;
                } 
                else if (type === 'child') {
                    titleLabel.innerText = "üë∂ –ü—Ä–∞–∫—Ç–∏–∫–∞ (–î–µ—Ç–∏)";
                    textDisplay.innerHTML = day1_texts.child; // –ë–µ—Ä–µ–º –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
                    textBox.style.display = 'block';
                    audioBox.style.display = 'block'; 
                    audioPlayer.src = `https://goloka-gid.github.io/audio/day1_child.mp3`;
                    scrollBtn.classList.add('visible');
                } 
                else if (type === 'adult') {
                    titleLabel.innerText = "üßò‚Äç‚ôÄÔ∏è –ü—Ä–∞–∫—Ç–∏–∫–∞ (–í–∑—Ä)";
                    textDisplay.innerHTML = day1_texts.adult; // –ë–µ—Ä–µ–º –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
                    textBox.style.display = 'block';
                    audioBox.style.display = 'block'; 
                    audioPlayer.src = `https://goloka-gid.github.io/audio/day1_adult.mp3`;
                    scrollBtn.classList.add('visible');
                }
            } else {
                // –î–õ–Ø –î–†–£–ì–ò–• –î–ù–ï–ô (–°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞)
                // –ü–æ–∫–∞ –æ—Å—Ç–∞–≤–∏–º –∑–∞–≥–ª—É—à–∫—É, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –î–µ–Ω—å 1
                textDisplay.innerHTML = "<p style='text-align:center'>–ó–∞–≥—Ä—É–∑–∫–∞...</p>";
                textBox.style.display = 'block';
            }
            
            if (audioBox.style.display === 'block') audioPlayer.load();
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–°—Ç–∞—Ä—ã–µ)
        function switchView(viewId) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active-view'));
            document.getElementById(viewId).classList.add('active-view');
        }
        function goBackToMenu() { stopScroll(); document.getElementById('audio-player').pause(); document.getElementById('video-player').pause(); switchView('view-menu'); }
        function goHome() { stopScroll(); document.getElementById('audio-player').pause(); document.getElementById('video-player').pause(); switchView('view-grid'); }
        let scrollInterval; let isScrolling = false;
        function toggleAutoScroll() { const container = document.getElementById('scroll-box'); const btn = document.getElementById('scroll-btn'); if (isScrolling) { clearInterval(scrollInterval); btn.classList.remove('active'); } else { scrollInterval = setInterval(() => { container.scrollTop += 1; }, 35); btn.classList.add('active'); } isScrolling = !isScrolling; }
        function stopScroll() { clearInterval(scrollInterval); isScrolling = false; const btn = document.getElementById('scroll-btn'); if(btn) btn.classList.remove('active'); }
        function resetApp() { if(confirm("–°–±—Ä–æ—Å–∏—Ç—å?")) { localStorage.clear(); location.reload(); } }

        const tg = window.Telegram.WebApp; tg.ready(); tg.expand(); tg.setHeaderColor('#fdfbf7'); tg.setBackgroundColor('#fdfbf7');
        tg.BackButton.onClick(() => { if (document.getElementById('view-menu').classList.contains('active-view')) goHome(); else if (document.getElementById('view-content').classList.contains('active-view')) goBackToMenu(); });
        setInterval(() => { if (document.getElementById('view-grid').classList.contains('active-view')) tg.BackButton.hide(); else tg.BackButton.show(); }, 200);
    </script>
</body>
</html>
